{
  "hash": "7a887c30860d23402fd80464f848245c",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Hands-on_Ex09(a)\"\ndate: \"Jun 14, 2024\"\ndata-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n\n# **Creating Ternary Plot with R**\n\n## **Overview**\n\n## Data Preparation\n\n### **Install and launching R package**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(plotly, ggtern, tidyverse)\n```\n:::\n\n\n### **Import Data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\npop_data <- read.csv(\"data/respopagsex2000to2018_tidy.csv\")\n```\n:::\n\n\n### **Prepate the Data**\n\n\n::: {.cell}\n\n```{.r .cell-code}\nagpop_mutated <- pop_data %>%\n  mutate('YEAR' = as.character(Year)) %>%\n  spread(AG, Population) %>%\n  mutate(across(4:22, as.numeric)) %>%\n  mutate(YOUNG = rowSums(.[4:8])) %>%\n  mutate(ACTIVE = rowSums(.[9:16])) %>%\n  mutate(OLD = rowSums(.[17:21])) %>%\n  mutate(TOTAL = rowSums(.[22:24])) %>%\n  filter(Year == 2018) %>%\n  filter(TOTAL > 0)\n```\n:::\n\n\n## Plotting Ternary\n\n### Plotting a static ternary diagram\n\n\n::: {.cell}\n\n```{.r .cell-code}\nggtern(data = agpop_mutated, aes(x = YOUNG, y = ACTIVE, z = OLD)) +\n  geom_point()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex09_files/figure-html/unnamed-chunk-4-1.png){width=672}\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nggtern(data = agpop_mutated, aes(x = YOUNG, y = ACTIVE, z = OLD)) +\n  geom_point() +\n  labs(title = \"Population structure, 2015\") +\n  theme_rgbw()\n```\n\n::: {.cell-output-display}\n![](Hands-on_Ex09_files/figure-html/unnamed-chunk-5-1.png){width=672}\n:::\n:::\n\n\n### Plotting an interative ternary diagram\n\n\n::: {.cell}\n\n```{.r .cell-code}\nlabel <- function(txt){\n  list(\n    text = txt,\n    x = 0.1, y = 1,\n    ax = 0, ay = 0,\n    xref = \"paper\", yref = \"paper\",\n    align = \"center\",\n    font = list(family = \"serif\", size = 15, color = \"white\"),\n    bgcolor =  \"#b3b3b3\", bordercolor = \"black\", borderwidth = 2\n  )\n}\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\naxis <- function(txt){\n  list(\n    title = txt, tickformat = \".0%\", tickfont = list(size = 10)\n  )\n}\nternaryAxes <- list(\n  aaxis = axis(\"Young\"),\n  baxis = axis(\"Active\"),\n  caxis = axis(\"Old\")\n)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nplot_ly(\n  agpop_mutated,\n  a = ~YOUNG,\n  b = ~ACTIVE,\n  c = ~OLD,\n  color = I(\"black\"),\n  type = \"scatterternary\"\n) %>%\n  layout(\n    annotations = label(\"Ternary Markers\"),\n    ternary = ternaryAxes\n  )\n```\n\n::: {.cell-output-display}\n\n```{=html}\n<div class=\"plotly html-widget html-fill-item\" id=\"htmlwidget-12bdc0634b88416e7642\" style=\"width:100%;height:464px;\"></div>\n<script type=\"application/json\" data-for=\"htmlwidget-12bdc0634b88416e7642\">{\"x\":{\"visdat\":{\"8374412c964e\":[\"function () \",\"plotlyVisDat\"]},\"cur_data\":\"8374412c964e\",\"attrs\":{\"8374412c964e\":{\"a\":{},\"b\":{},\"c\":{},\"color\":[\"black\"],\"alpha_stroke\":1,\"sizes\":[10,100],\"spans\":[1,20],\"type\":\"scatterternary\"}},\"layout\":{\"margin\":{\"b\":40,\"l\":60,\"t\":25,\"r\":10},\"annotations\":[{\"text\":\"Ternary Markers\",\"x\":0.10000000000000001,\"y\":1,\"ax\":0,\"ay\":0,\"xref\":\"paper\",\"yref\":\"paper\",\"align\":\"center\",\"font\":{\"family\":\"serif\",\"size\":15,\"color\":\"white\"},\"bgcolor\":\"#b3b3b3\",\"bordercolor\":\"black\",\"borderwidth\":2},{\"text\":\"Ternary Markers\",\"x\":0.10000000000000001,\"y\":1,\"ax\":0,\"ay\":0,\"xref\":\"paper\",\"yref\":\"paper\",\"align\":\"center\",\"font\":{\"family\":\"serif\",\"size\":15,\"color\":\"white\"},\"bgcolor\":\"#b3b3b3\",\"bordercolor\":\"black\",\"borderwidth\":2},{\"text\":\"Ternary Markers\",\"x\":0.10000000000000001,\"y\":1,\"ax\":0,\"ay\":0,\"xref\":\"paper\",\"yref\":\"paper\",\"align\":\"center\",\"font\":{\"family\":\"serif\",\"size\":15,\"color\":\"white\"},\"bgcolor\":\"#b3b3b3\",\"bordercolor\":\"black\",\"borderwidth\":2}],\"ternary\":{\"aaxis\":{\"title\":\"Young\",\"tickformat\":\".0%\",\"tickfont\":{\"size\":10}},\"baxis\":{\"title\":\"Active\",\"tickformat\":\".0%\",\"tickfont\":{\"size\":10}},\"caxis\":{\"title\":\"Old\",\"tickformat\":\".0%\",\"tickfont\":{\"size\":10}}},\"hovermode\":\"closest\",\"showlegend\":false},\"source\":\"A\",\"config\":{\"modeBarButtonsToAdd\":[\"hoverclosest\",\"hovercompare\"],\"showSendToCloud\":false},\"data\":[{\"a\":[3088,6498,6068,5718,3428,4648,3548,5568,2018,2818,2018,6648,3718,16098,7578,10178,9358,8528,8478,3088,6818,7978,7358,2018,2018,2018,2018,3358,7288,4118,5178,5018,4178,4578,5918,6948,4338,2378,4368,2208,2018,3398,3378,3808,3368,2728,4568,2018,5128,3808,3538,4418,5088,5908,3598,8868,7948,2858,8518,7508,6408,3628,3608,4378,4798,3398,3328,4298,2018,2018,2108,2568,2018,6588,9138,10598,9198,6448,11628,4458,7058,4858,5078,3528,2018,3028,2018,3648,2018,2018,2108,2048,2128,2018,2018,2018,2018,2018,2018,2088,8438,7548,2018,4148,6748,2018,2818,6838,8868,8168,6998,7438,2018,4648,10938,2018,2108,2018,2018,2128,2018,5788,4808,6138,5648,9068,2018,12248,17588,2018,2018,10898,4348,16188,8158,3968,3128,3858,2018,2118,3848,3658,4418,2028,2018,2478,2018,2018,2018,2018,3918,2018,7388,4188,2018,2038,2038,2818,2328,2018,2228,2058,2318,2018,7738,2868,2728,4478,2158,2098,2028,2118,2138,4078,2978,2018,5168,2408,2018,8788,12958,4058,2018,10088,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,2018,16568,2068,2018,15588,7378,16588,3088,4298,4458,3768,2158,5528,4688,2058,2168,2898,2588,2018,2048,2048,3848,2848,2598,2388,2278,2078,2178,2488,2018,2488,2048,2258,2018,2048,2378,2188,2018,2018,2088,2018,5718,9398,4108,8718,3568,2428,2018,2018,2018,14558,8038,17898,2018,16148,16608,2018,3828,4708,5828,7988,5148,2018,4798,2018,2018,2018,2018,2018,2028,2668,2448,2018,2018,2018,2018,2018,2018,2138,9838,27338,2018,18128,2308,3408,4448,2318,2798,2018,2018,4278,3758,3458,3188,3078,3828,3728,3028,7658,4098,2588,2018,2018,2018,2018,2018,2018,2018,2018,2018,2158,2018,10528,4158,2018,9178,26068,2018,13268,7718,3628,6848,2208,7368,2858,2208,16498,9318,12058],\"b\":[2730,16100,14910,12780,3720,9260,4610,11920,0,2410,0,14100,4300,46910,15280,26670,19200,22740,21630,3450,16570,18050,16310,0,0,0,0,3350,15680,7970,9410,9150,5880,8000,11680,16160,7540,910,8050,600,0,3690,4530,6010,4940,1900,6880,0,10180,6670,5220,7120,8880,13840,4100,17150,19570,2310,15940,12200,12380,3400,3480,4950,5910,3640,3080,5860,0,0,330,870,0,13560,20960,20610,21020,15340,25980,7600,16360,8920,8680,3430,0,3310,0,3500,0,0,490,190,490,0,0,0,0,0,0,440,23320,17720,0,7480,15970,0,2870,15640,28060,17810,14990,18520,0,8000,26530,0,290,0,0,500,0,10790,9320,14540,11480,17960,0,31970,40450,0,0,23390,4930,43030,20600,6810,4470,6700,0,480,6040,5550,6510,30,0,1290,0,0,0,0,5430,0,14640,5940,0,190,110,2190,680,0,590,150,910,0,18710,2060,1470,5350,390,240,90,270,810,6180,3460,220,8990,1280,0,19370,35110,4670,0,23070,0,0,0,0,0,0,0,0,0,0,0,28940,140,0,28400,10760,28640,4060,6300,7280,7140,490,8660,8910,210,460,2710,1910,70,210,70,6500,2130,1810,1110,860,130,720,1630,100,1890,90,920,0,160,1140,1060,0,0,150,0,8490,18930,5750,15850,3700,1040,0,0,0,26030,12760,31780,0,36630,37840,0,4930,7770,14450,20540,9890,0,9400,0,0,0,0,80,120,1770,1160,0,0,0,0,0,0,400,24420,81010,0,48110,1110,3970,5220,790,2090,0,0,7090,5530,4660,4700,4120,5920,6230,2960,16530,7920,1440,0,0,0,0,0,0,0,0,0,480,0,22760,7710,0,22220,61100,0,25050,18570,6420,9390,540,17830,2380,840,34700,25130,33540],\"c\":[970,7310,7600,6100,1510,4310,1850,6020,0,930,0,5940,1140,20290,4790,12300,6830,8820,9670,1880,6980,5930,7220,0,0,0,0,380,5410,3100,2380,3160,1930,2370,3270,5510,4030,150,4350,310,0,1240,2320,3400,2980,510,2410,0,4360,3960,2810,2990,3390,4900,980,4310,6150,640,3700,2850,4970,1280,1080,1630,1830,1360,1120,2470,0,0,160,70,0,3230,4560,3410,5230,5210,5610,3560,7540,3910,3790,900,0,1630,0,1010,0,0,250,0,70,0,0,0,0,0,0,70,9430,7390,0,2590,6770,0,1020,4400,10900,6020,5390,8030,0,3310,8430,0,30,0,0,290,0,4540,3010,6440,4580,4960,0,12180,9370,0,0,6100,1050,11270,8560,3180,3110,3150,0,250,2650,2350,2020,20,0,360,0,0,0,0,1870,0,6830,2060,0,30,20,670,160,0,180,40,380,0,7230,900,580,1290,180,120,10,80,550,2380,2600,70,2330,460,110,4210,9430,530,0,4800,0,0,0,0,0,0,0,0,0,0,0,4290,50,0,6130,1310,4120,2080,2560,3530,3930,210,2600,3860,0,40,770,770,30,70,0,3120,520,420,410,310,10,360,660,20,990,0,160,0,50,640,650,0,0,10,0,1890,4010,620,3510,850,270,0,0,0,4990,2340,5780,0,9480,8430,0,1650,3230,6520,9980,3120,0,3810,0,0,0,0,40,0,300,210,0,0,0,0,0,0,180,7670,27360,0,15030,330,1070,1630,300,720,0,0,3850,2500,1720,2280,2180,2840,3210,1270,6140,3920,400,0,0,0,0,0,0,0,0,0,90,0,4470,2920,0,4930,11440,0,4690,6250,2410,1030,190,5630,960,340,7490,8010,11590],\"type\":\"scatterternary\",\"mode\":\"markers\",\"marker\":{\"color\":\"rgba(0,0,0,1)\",\"line\":{\"color\":\"rgba(0,0,0,1)\"}},\"textfont\":{\"color\":\"rgba(0,0,0,1)\"},\"line\":{\"color\":\"rgba(0,0,0,1)\"},\"frame\":null}],\"highlight\":{\"on\":\"plotly_click\",\"persistent\":false,\"dynamic\":false,\"selectize\":false,\"opacityDim\":0.20000000000000001,\"selected\":{\"opacity\":1},\"debounce\":0},\"shinyEvents\":[\"plotly_hover\",\"plotly_click\",\"plotly_selected\",\"plotly_relayout\",\"plotly_brushed\",\"plotly_brushing\",\"plotly_clickannotation\",\"plotly_doubleclick\",\"plotly_deselect\",\"plotly_afterplot\",\"plotly_sunburstclick\"],\"base_url\":\"https://plot.ly\"},\"evals\":[],\"jsHooks\":[]}</script>\n```\n\n:::\n:::\n",
    "supporting": [
      "Hands-on_Ex09_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {
      "include-in-header": [
        "<script src=\"../../site_libs/htmlwidgets-1.6.4/htmlwidgets.js\"></script>\n<script src=\"../../site_libs/plotly-binding-4.10.4/plotly.js\"></script>\n<script src=\"../../site_libs/typedarray-0.1/typedarray.min.js\"></script>\n<script src=\"../../site_libs/jquery-3.5.1/jquery.min.js\"></script>\n<link href=\"../../site_libs/crosstalk-1.2.1/css/crosstalk.min.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/crosstalk-1.2.1/js/crosstalk.min.js\"></script>\n<link href=\"../../site_libs/plotly-htmlwidgets-css-2.11.1/plotly-htmlwidgets.css\" rel=\"stylesheet\" />\n<script src=\"../../site_libs/plotly-main-2.11.1/plotly-latest.min.js\"></script>\n"
      ]
    },
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}