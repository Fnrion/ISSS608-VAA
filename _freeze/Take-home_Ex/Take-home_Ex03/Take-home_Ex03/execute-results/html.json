{
  "hash": "30786facc0328e60c1f550ea17f9703d",
  "result": {
    "engine": "knitr",
    "markdown": "---\ntitle: \"Take_home_Ex03\"\nauthor: \"Zou Jiaxun\"\ndate: \"Jun 7, 2024\"\ndata-modified: \"last-modified\"\nexecute: \n  eval: true\n  echo: true\n  warning: false\n  freeze: true\n---\n\n### Package Preparation\n\n\n::: {.cell}\n\n```{.r .cell-code}\npacman::p_load(tidyverse, readtext,\n               quanteda, tidytext, jsonlite,\n               tidyr, tidygraph, ggraph, igraph,\n               visNetwork, ggplot2, gganimate)\n```\n:::\n\n\n## Data Preparation\n\n### Data Load\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_data <- fromJSON(\"data/MC3/mc3 1.json\")\nclass(mc3_data)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\n[1] \"list\"\n```\n\n\n:::\n:::\n\n\n### Data Check\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_edges <- as_tibble(mc3_data$link)\nglimpse(mc3_edges)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 75,817\nColumns: 11\n$ start_date          <chr> \"2016-10-29T00:00:00\", \"2035-06-03T00:00:00\", \"202…\n$ type                <chr> \"Event.Owns.Shareholdership\", \"Event.Owns.Sharehol…\n$ `_last_edited_by`   <chr> \"Pelagia Alethea Mordoch\", \"Niklaus Oberon\", \"Pela…\n$ `_last_edited_date` <chr> \"2035-01-01T00:00:00\", \"2035-07-15T00:00:00\", \"203…\n$ `_date_added`       <chr> \"2035-01-01T00:00:00\", \"2035-07-15T00:00:00\", \"203…\n$ `_raw_source`       <chr> \"Existing Corporate Structure Data\", \"Oceanus Corp…\n$ `_algorithm`        <chr> \"Automatic Import\", \"Manual Entry\", \"Automatic Imp…\n$ source              <chr> \"Avery Inc\", \"Berger-Hayes\", \"Bowers Group\", \"Bowm…\n$ target              <chr> \"Allen, Nichols and Thompson\", \"Jensen, Morris and…\n$ key                 <int> 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0,…\n$ end_date            <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n```\n\n\n:::\n\n```{.r .cell-code}\n#   distinct() %>%\n#   mutate(source = as.character(source),\n#          target = as.character(target),\n#          type = as.character(type)) %>%\n#   group_by(source, target) %>%\n#   summarise(weights = n(), .groups = 'drop') %>%\n#   filter(source != target)\n# glimpse(mc3_edges)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_nodes <- as_tibble(mc3_data$nodes)\nglimpse(mc3_nodes)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60,520\nColumns: 15\n$ type                <chr> \"Entity.Organization.Company\", \"Entity.Organizatio…\n$ country             <chr> \"Uziland\", \"Mawalara\", \"Uzifrica\", \"Islavaragon\", …\n$ ProductServices     <chr> \"Unknown\", \"Furniture and home accessories\", \"Food…\n$ PointOfContact      <chr> \"Rebecca Lewis\", \"Michael Lopez\", \"Steven Robertso…\n$ HeadOfOrg           <chr> \"Émilie-Susan Benoit\", \"Honoré Lemoine\", \"Jules La…\n$ founding_date       <chr> \"1954-04-24T00:00:00\", \"2009-06-12T00:00:00\", \"202…\n$ revenue             <dbl> 5994.73, 71766.67, 0.00, 0.00, 4746.67, 46566.67, …\n$ TradeDescription    <chr> \"Unknown\", \"Abbott-Gomez is a leading manufacturer…\n$ `_last_edited_by`   <chr> \"Pelagia Alethea Mordoch\", \"Pelagia Alethea Mordoc…\n$ `_last_edited_date` <chr> \"2035-01-01T00:00:00\", \"2035-01-01T00:00:00\", \"203…\n$ `_date_added`       <chr> \"2035-01-01T00:00:00\", \"2035-01-01T00:00:00\", \"203…\n$ `_raw_source`       <chr> \"Existing Corporate Structure Data\", \"Existing Cor…\n$ `_algorithm`        <chr> \"Automatic Import\", \"Automatic Import\", \"Automatic…\n$ id                  <chr> \"Abbott, Mcbride and Edwards\", \"Abbott-Gomez\", \"Ab…\n$ dob                 <chr> NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA, NA…\n```\n\n\n:::\n\n```{.r .cell-code}\n#   mutate(country = as.character(country), \n#          id = as.character(id), \n#          product_services = as.character(ProductServices), \n#          revenue_omu = as.numeric(as.character(revenue)), \n#          type = as.character(type)) %>%\n#   select(id, country, product_services, revenue_omu, type)\n# glimpse(mc3_nodes)\n```\n:::\n\n\n## *MC3 Task(3) Develop a visual approach to examine inferences. Infer how the influence of a company changes through time. Can you infer ownership and influence that a network may have?*\n\n:::callout-idea\nBased on this task, we need to check the inferences, and how the company changes through time, so the edge types like {Shareholdership, BeneficialOwnership, WorksFor, FamilyRelationship} will be used, and the company name to define company; Meanwhile, the type in node like  (Entity.Organization, Entity.Organization.Company, Entity.Organization.FishingCompany, Entity.Organization.LogisticsCompany, Entity.Organization.NewsCompany, Entity.Organization.FinancialCompany, Entity.Organization.NGO) will be used, source and target will be choosed to decide the arrow.\n:::\n\n\n::: {.cell}\n\n```{.r .cell-code}\nmc3_edges_filt <- mc3_edges %>% select(type, source, target)\nmc3_nodes_filt <- mc3_nodes %>% select(type, id)\nglimpse(mc3_edges_filt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 75,817\nColumns: 3\n$ type   <chr> \"Event.Owns.Shareholdership\", \"Event.Owns.Shareholdership\", \"Ev…\n$ source <chr> \"Avery Inc\", \"Berger-Hayes\", \"Bowers Group\", \"Bowman-Howe\", \"Bo…\n$ target <chr> \"Allen, Nichols and Thompson\", \"Jensen, Morris and Downs\", \"Bar…\n```\n\n\n:::\n\n```{.r .cell-code}\nglimpse(mc3_nodes_filt)\n```\n\n::: {.cell-output .cell-output-stdout}\n\n```\nRows: 60,520\nColumns: 2\n$ type <chr> \"Entity.Organization.Company\", \"Entity.Organization.Company\", \"En…\n$ id   <chr> \"Abbott, Mcbride and Edwards\", \"Abbott-Gomez\", \"Abbott-Harrison\",…\n```\n\n\n:::\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# graph <- frame(d = mc3_edges_filt, vertices = mc3_nodes_filt, directed = TRUE)\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# mc3_graph <- tbl_graph(nodes = mc3_nodes1,\n#                        edges = mc3_edges,\n#                        directed = FALSE) %>%\n#   mutate(betweenness_centrality = centrality_betweenness(), closeness_centrality = centrality_closeness())\n```\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# mc3_graph %>%\n#   filter(betweenness_centrality >= 300000) %>%\n#   ggraph(layout = 'fr') + geom_edge_link(aes(alpha = 0.5)) +\n#   geom_node_point(aes(\n#     size = betweenness_centrality,\n#     colors = \"lightblue\",\n#     alpha = 0.1)) +\n#   scale_size_continuous(range=c(1,10))+\n#   theme_graph()\n```\n:::\n\nText sensing to extract text\n\n\n## MC3 Task(4) Identify the network associated with SouthSeafood Express Corp and visualize how this network and competing businesses change as a result of their illegal fishing behavior. Which companies benefited from SouthSeafood Express Corp legal troubles? Are there other suspicious transactions that may be related to illegal fishing? Provide visual evidence for your conclusions.\n\n:::callout-idea\nto check a certain Corp. through a timeline\n:::\n\n\n::: {.cell}\n\n:::\n\n::: {.cell}\n\n```{.r .cell-code}\n# # Load JSON data\n# # Create igraph object\n# nodes <- mc3_data$nodes\n# edges <- mc3_data$links\n# g <- graph_from_data_frame(d = edges, vertices = nodes, directed = TRUE)\n# # Basic network plot\n# plot(g, vertex.label = NA, vertex.size = 5, edge.arrow.size = 0.5)\n```\n:::\n",
    "supporting": [
      "Take-home_Ex03_files"
    ],
    "filters": [
      "rmarkdown/pagebreak.lua"
    ],
    "includes": {},
    "engineDependencies": {},
    "preserve": {},
    "postProcess": true
  }
}